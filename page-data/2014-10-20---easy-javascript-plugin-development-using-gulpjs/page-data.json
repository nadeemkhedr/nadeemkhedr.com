{"componentChunkName":"component---src-templates-blog-post-js","path":"/2014-10-20---easy-javascript-plugin-development-using-gulpjs/","result":{"data":{"site":{"siteMetadata":{"title":"Nadeem Khedr"}},"markdownRemark":{"id":"de856d92-fad8-5ed0-b727-2c7f1d731983","excerpt":"I’ll be showing how to setup a build environment suitable for developing a sophisticated JavaScript plugin Build System: Gulp.js We don’t want to end up writing…","html":"<p>I’ll be showing how to setup a build environment suitable for developing a sophisticated JavaScript plugin</p>\n<h2>Build System: Gulp.js</h2>\n<p>We don’t want to end up writing all the code in one huge JavaScript file, so using <a href=\"http://gulpjs.com/\">gulp.js </a>actually gives us  lots of features:</p>\n<ul>\n<li>Modularizing our code in multiple files and concating/minifying it at run time</li>\n<li>Gives us the ability to write our code using higher level languages like <a href=\"http://coffeescript.org/\">CoffeeScript</a>, <a href=\"http://sass-lang.com/\">Sass</a> , etc.. and will compile them at run time</li>\n<li>A local  web server to to host our plugin and the styling code ( sometime that’s needed if you have different development and deployment workflows )</li>\n<li>Enable <a href=\"http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/\" title=\"Introduction to JavaScript Source Maps\">sourcemaps</a> while developing</li>\n<li>Use watchers to recompile files on change &#x26; also for browser reload</li>\n</ul>\n<h3>Our Directory will look like this</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"> /plugin\n /src\n /styles\n /dist\n package.json\n gulpfile.js</code></pre></div>\n<p><strong>/src</strong> Directory contains all the plugin code <em>(can be javascript/coffeescript)</em></p>\n<p><strong>/styles</strong> Directory contains all the styling code <em>(can be sass/less/css)</em></p>\n<p><strong>/dist</strong> Directory contains all the compiled plugin files <em>(plugin.js, plugin-styles.css, images, etc..)</em></p>\n<p><strong>package.json</strong> contains all the npm modules that our app depends on <em>(the dependencies are not javascript dependencies for our plugin but our gulp plugins that we will use in our build)</em></p>\n<p><strong>gulpfile.js</strong> Here is where all the build magic happens</p>\n<h3>Package.json</h3>\n<p>To get started in our plugin root folder we need to run</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">npm init</code></pre></div>\n<p>it will asks us multiple questions and in the end will generate\na <code class=\"language-text\">package.json</code></p>\n<p>Then we need to install the following plugins because we will be using them in our gulp file <a href=\"https://github.com/wearefractal/gulp-concat\">gulp-concat</a>, <a href=\"https://github.com/schickling/gulp-webserver\">gulp-webserver</a>, <a href=\"https://github.com/floridoo/gulp-sourcemaps\">gulp-sourcemaps</a> and <a href=\"https://github.com/dlmanning/gulp-sass\">gulp-sass</a></p>\n<p>install them by typing the following in your command line</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">npm install gulp gulp-concat gulp-webserver gulp-sourcemaps gulp-sass --save-dev</code></pre></div>\n<blockquote>\n<p>you need to also install gulp globally if you didn’t <code class=\"language-text\">npm install -g gulp</code></p>\n</blockquote>\n<h3>Our Gulp file</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// /plugin/gulpfile.js</span>\n<span class=\"token keyword\">var</span> gulp <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gulp'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  webserver <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gulp-webserver'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  concat <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gulp-concat'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  sourcemaps <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gulp-sourcemaps'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  sass <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gulp-sass'</span><span class=\"token punctuation\">)</span>\n\ngulp<span class=\"token punctuation\">.</span><span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sass'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> gulp<span class=\"token punctuation\">.</span><span class=\"token function\">src</span><span class=\"token punctuation\">(</span><span class=\"token string\">'styles/*.scss'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">sass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>gulp<span class=\"token punctuation\">.</span><span class=\"token function\">dest</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dist'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\ngulp<span class=\"token punctuation\">.</span><span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token string\">'scripts'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> gulp\n    <span class=\"token punctuation\">.</span><span class=\"token function\">src</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'src/app.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'src/!(main)*.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'src/main.js'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>sourcemaps<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token string\">'plugin.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>sourcemaps<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>gulp<span class=\"token punctuation\">.</span><span class=\"token function\">dest</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dist'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\ngulp<span class=\"token punctuation\">.</span><span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token string\">'watch'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  gulp<span class=\"token punctuation\">.</span><span class=\"token function\">watch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'src/*.js'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'scripts'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  gulp<span class=\"token punctuation\">.</span><span class=\"token function\">watch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'styles/*.scss'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'sass'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\ngulp<span class=\"token punctuation\">.</span><span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token string\">'server'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'scripts'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sass'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'watch'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  gulp<span class=\"token punctuation\">.</span><span class=\"token function\">src</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dist'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">webserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> port<span class=\"token operator\">:</span> <span class=\"token number\">9001</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Our gulp file is pretty basic it does the following</p>\n<ul>\n<li>Convert all the sass files to css and create them in the <code class=\"language-text\">dist</code> directory</li>\n<li>Concat all the javascript files into one file and create it in the <code class=\"language-text\">dist</code> directory\n<em>Note: In the result concatenated file we are specifying the first &#x26; last files to include app.js, main.js</em></li>\n<li>Watch the files &#x26; recompile on change</li>\n<li>Create a webserver that will have the <code class=\"language-text\">dist</code> directory as its root</li>\n</ul>\n<p>all we have to do to run &#x26; watch file changes is to run this command in the command line</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">gulp server</code></pre></div>\n<blockquote>\n<p><code class=\"language-text\">server</code> is the task name defined in our <code class=\"language-text\">gulpfile.js</code> and as you can see in our code that task depends on all other tasks (meaning it will run everything) and it will also fire up a server on port <code class=\"language-text\">9001</code> and the server’s root will be <code class=\"language-text\">/dist</code></p>\n</blockquote>\n<p>You can read more about gulp <a href=\"http://gulpjs.com/\">here</a>, It is extremely easy to use. With a little searching you can get tons of good examples of how to practically do anything with it</p>","frontmatter":{"title":"Easy Javascript plugin development using gulpjs","date":"October 20, 2014","description":null}},"previous":{"fields":{"slug":"/2014-08-24---how-to-call-onroutechange-and-onrouteexit-in-ember-js/"},"frontmatter":{"title":"How to call onRouteChange and onRouteExit in Ember.js"}},"next":{"fields":{"slug":"/2016-02-04---learning-react-setting-up-the-environment/"},"frontmatter":{"title":"Learning React: #1 Setting up the environment"}}},"pageContext":{"id":"de856d92-fad8-5ed0-b727-2c7f1d731983","previousPostId":"37b06ce3-5213-5e61-b381-d351315aaf6d","nextPostId":"292eb9a3-1708-5960-a614-02e6c80fb347"}},"staticQueryHashes":["2841359383","3257411868"]}